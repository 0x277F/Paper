From 72d067e07529a0956527bc3c100f42abe36909d2 Mon Sep 17 00:00:00 2001
From: Iceee <andrew@opticgaming.tv>
Date: Wed, 2 Mar 2016 01:39:52 -0600
Subject: [PATCH] Fix lag from explosions processing dead entities


diff --git a/src/main/java/net/minecraft/world/Explosion.java b/src/main/java/net/minecraft/world/Explosion.java
index 4fafcb0..53ee428 100644
--- a/src/main/java/net/minecraft/world/Explosion.java
+++ b/src/main/java/net/minecraft/world/Explosion.java
@@ -20,6 +20,7 @@ import net.minecraft.entity.projectile.EntityFireball;
 import net.minecraft.init.Blocks;
 import net.minecraft.init.SoundEvents;
 import net.minecraft.util.DamageSource;
+import net.minecraft.util.EntitySelectors; // Paper
 import net.minecraft.util.EnumParticleTypes;
 import net.minecraft.util.SoundCategory;
 import net.minecraft.util.math.AxisAlignedBB;
@@ -113,7 +114,7 @@ public class Explosion {
             int i1 = MathHelper.floor(this.explosionY + (double)f3 + 1.0D);
             int j1 = MathHelper.floor(this.explosionZ - (double)f3 - 1.0D);
             int k1 = MathHelper.floor(this.explosionZ + (double)f3 + 1.0D);
-            List list = this.world.getEntitiesWithinAABBExcludingEntity(this.exploder, new AxisAlignedBB((double)i, (double)l, (double)j1, (double)j, (double)i1, (double)k1));
+            List list = this.world.getEntitiesInAABBexcluding(this.exploder, new AxisAlignedBB((double)i, (double)l, (double)j1, (double)j, (double)i1, (double)k1), input -> EntitySelectors.IS_ALIVE.apply(input)); // Paper - Fix lag from explosions processing dead entities
             Vec3d vec3d = new Vec3d(this.explosionX, this.explosionY, this.explosionZ);
 
             for (int l1 = 0; l1 < list.size(); ++l1) {
-- 
2.12.1.windows.1

