From c370969af8080b3d8b8b95e576f25df31c810497 Mon Sep 17 00:00:00 2001
From: Byteflux <byte@byteflux.net>
Date: Tue, 1 Mar 2016 14:27:13 -0600
Subject: [PATCH] Configurable speed for water flowing over lava


diff --git a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
index 0f4f241..46bd479 100644
--- a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
+++ b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
@@ -130,4 +130,10 @@ public class PaperWorldConfig {
         if (fallingBlockHeightNerf != 0) log("Falling Block Height Limit set to Y: " + fallingBlockHeightNerf);
         if (entityTNTHeightNerf != 0) log("TNT Entity Height Limit set to Y: " + entityTNTHeightNerf);
     }
+
+    public int waterOverLavaFlowSpeed;
+    private void waterOverLawFlowSpeed() {
+        waterOverLavaFlowSpeed = getInt("water-over-lava-flow-speed", 5);
+        log("Water over lava flow speed: " + waterOverLavaFlowSpeed);
+    }
 }
diff --git a/src/main/java/net/minecraft/block/BlockDynamicLiquid.java b/src/main/java/net/minecraft/block/BlockDynamicLiquid.java
index fec6079..742a995 100644
--- a/src/main/java/net/minecraft/block/BlockDynamicLiquid.java
+++ b/src/main/java/net/minecraft/block/BlockDynamicLiquid.java
@@ -34,7 +34,7 @@ public class BlockDynamicLiquid extends BlockLiquid {
             b0 = 2;
         }
 
-        int j = this.tickRate(worldIn);
+        int j = this.getTickRate(worldIn, pos); // Paper
 
         if (i > 0) {
             int l = -100;
@@ -248,7 +248,21 @@ public class BlockDynamicLiquid extends BlockLiquid {
      */
     public void onBlockAdded(World worldIn, BlockPos pos, IBlockState state) {
         if (!this.checkForMixing(worldIn, pos, state)) {
-            worldIn.scheduleUpdate(pos, this, this.tickRate(worldIn));
+            worldIn.scheduleUpdate(pos, this, this.getTickRate(worldIn, pos)); // Paper
         }
     }
+
+    /**
+     * Paper - Gets how many ticks before this block is ticked
+     */
+    public int getTickRate(World world, BlockPos pos) {
+        if (this.blockMaterial == Material.WATER && (
+                world.getBlockState(pos.north(1)).getBlock().blockMaterial == Material.LAVA ||
+                        world.getBlockState(pos.south(1)).getBlock().blockMaterial == Material.LAVA ||
+                        world.getBlockState(pos.west(1)).getBlock().blockMaterial == Material.LAVA ||
+                        world.getBlockState(pos.east(1)).getBlock().blockMaterial == Material.LAVA)) {
+            return world.paperConfig.waterOverLavaFlowSpeed;
+        }
+        return super.tickRate(world);
+    }
 }
-- 
2.12.1.windows.1

